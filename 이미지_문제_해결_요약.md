# ì´ë¯¸ì§€ ì—…ë¡œë“œ ë° í‘œì‹œ ë¬¸ì œ í•´ê²° ìš”ì•½

## ğŸ” ë¬¸ì œ ìƒí™©

- **ë¡œì»¬**: ì´ë¯¸ì§€ ì—…ë¡œë“œ ë° í‘œì‹œ ì •ìƒ ì‘ë™ âœ…
- **ì‹¤ì„œë²„ (IP)**: ì´ë¯¸ì§€ ì—…ë¡œë“œ ë° í‘œì‹œ ì •ìƒ ì‘ë™ âœ…
- **ì‹¤ì„œë²„ (ë„ë©”ì¸ + SSL)**: ì—…ë¡œë“œëŠ” ë˜ì§€ë§Œ ì—ë””í„°ì™€ í† ë¡  ìƒì„¸ì—ì„œ ì´ë¯¸ì§€ê°€ ë³´ì´ì§€ ì•ŠìŒ âŒ

## ğŸ¯ ì›ì¸

1. **Nginx HTTPS ì„¤ì •ì— `/files` ê²½ë¡œ ëˆ„ë½** - ê°€ì¥ ì¤‘ìš”í•œ ì›ì¸
2. **Mixed Content ë¬¸ì œ** - HTTPS í˜ì´ì§€ì—ì„œ HTTP ì´ë¯¸ì§€ ë¡œë“œ ì‹œë„
3. **ì´ë¯¸ì§€ URL í”„ë¡œí† ì½œ ë¶ˆì¼ì¹˜** - ìƒëŒ€ ê²½ë¡œê°€ ì ˆëŒ€ ê²½ë¡œë¡œ ë³€í™˜ë  ë•Œ í”„ë¡œí† ì½œ ì¼ì¹˜ í™•ì¸ ë¶€ì¡±

## âœ… í•´ê²° ë°©ë²•

### 1. Nginx ì„¤ì • ìˆ˜ì • (í•„ìˆ˜!)

**íŒŒì¼**: `debate-https.nginx` (í”„ë¡œì íŠ¸ ë£¨íŠ¸ì— ìƒì„±ë¨)

**ì„œë²„ì— ì ìš©**:

```bash
# 1. ì„œë²„ì— SSH ì ‘ì†
ssh -i private_info/AWS/debate2025.pem ubuntu@13.209.254.24

# 2. Nginx ì„¤ì • íŒŒì¼ ìˆ˜ì •
sudo nano /etc/nginx/sites-available/debate

# 3. HTTPS ì„œë²„ ë¸”ë¡ì— ë‹¤ìŒ ì¶”ê°€:
location /files {
    proxy_pass http://localhost:9001;
    proxy_http_version 1.1;
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_set_header X-Forwarded-Proto $scheme;

    proxy_cache_valid 200 1d;
    add_header Cache-Control "public, max-age=86400";
}

# 4. ì„¤ì • í…ŒìŠ¤íŠ¸ ë° ì¬ì‹œì‘
sudo nginx -t
sudo systemctl restart nginx
```

**ë˜ëŠ” ë¡œì»¬ì—ì„œ íŒŒì¼ ì—…ë¡œë“œ í›„ ì ìš©**:

```powershell
# debate-https.nginx íŒŒì¼ì„ ì„œë²„ì— ì—…ë¡œë“œ
scp -i private_info/AWS/debate2025.pem debate-https.nginx ubuntu@13.209.254.24:/tmp/

# ì„œë²„ì—ì„œ ì ìš©
ssh -i private_info/AWS/debate2025.pem ubuntu@13.209.254.24
sudo mv /tmp/debate-https.nginx /etc/nginx/sites-available/debate
sudo nginx -t
sudo systemctl restart nginx
```

### 2. í”„ë¡ íŠ¸ì—”ë“œ ì½”ë“œ ìˆ˜ì • (ì™„ë£Œ âœ…)

ë‹¤ìŒ íŒŒì¼ë“¤ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤:

#### ì‚¬ìš©ì í”„ë¡ íŠ¸ì—”ë“œ

- âœ… `DebateUser/DebateUserFrontEnd/src/pages/DebateCreatePage.jsx`
- âœ… `DebateUser/DebateUserFrontEnd/src/pages/DebateEditPage.jsx`
- âœ… `DebateUser/DebateUserFrontEnd/src/pages/DebateDetailPage.jsx`

#### ê´€ë¦¬ì í”„ë¡ íŠ¸ì—”ë“œ

- âœ… `DebateAdmin/DebateAdminFrontEnd/src/pages/DebatePage.jsx`

**ì£¼ìš” ë³€ê²½ì‚¬í•­**:

- ì´ë¯¸ì§€ URLì„ ì ˆëŒ€ ê²½ë¡œë¡œ ë³€í™˜í•  ë•Œ í”„ë¡œí† ì½œ ì¼ì¹˜ í™•ì¸
- HTTP URLì„ HTTPSë¡œ ìë™ ë³€í™˜ (Mixed Content ë°©ì§€)
- í† ë¡  ìƒì„¸ í˜ì´ì§€ì—ì„œ HTML ì½˜í…ì¸ ì˜ ì´ë¯¸ì§€ URL ë³€í™˜ í•¨ìˆ˜ ì¶”ê°€

### 3. í”„ë¡ íŠ¸ì—”ë“œ ì¬ë°°í¬ (í•„ìˆ˜!)

```bash
# ì‚¬ìš©ì í”„ë¡ íŠ¸ì—”ë“œ
cd DebateUser/DebateUserFrontEnd
npm run build

# ê´€ë¦¬ì í”„ë¡ íŠ¸ì—”ë“œ
cd DebateAdmin/DebateAdminFrontEnd
npm run build

# ì„œë²„ì— ë°°í¬ (ê¸°ì¡´ ë°°í¬ ìŠ¤í¬ë¦½íŠ¸ ì‚¬ìš©)
# ë˜ëŠ” ìˆ˜ë™ìœ¼ë¡œ dist í´ë”ë¥¼ ì„œë²„ì— ì—…ë¡œë“œ
```

## ğŸ“‹ í™•ì¸ ì²´í¬ë¦¬ìŠ¤íŠ¸

### ì„œë²„ ì„¤ì •

- [ ] Nginx HTTPS ì„¤ì •ì— `/files` ê²½ë¡œ ì¶”ê°€
- [ ] Nginx ì„¤ì • í…ŒìŠ¤íŠ¸ (`sudo nginx -t`)
- [ ] Nginx ì¬ì‹œì‘ (`sudo systemctl restart nginx`)
- [ ] Nginx ìƒíƒœ í™•ì¸ (`sudo systemctl status nginx`)

### í”„ë¡ íŠ¸ì—”ë“œ

- [ ] í”„ë¡ íŠ¸ì—”ë“œ ë¹Œë“œ ì™„ë£Œ
- [ ] ì„œë²„ì— ë°°í¬ ì™„ë£Œ

### í…ŒìŠ¤íŠ¸

- [ ] ë¸Œë¼ìš°ì €ì—ì„œ `https://debate.me.kr` ì ‘ì†
- [ ] í† ë¡  ì‘ì„± í˜ì´ì§€ì—ì„œ ì´ë¯¸ì§€ ì—…ë¡œë“œ í…ŒìŠ¤íŠ¸
- [ ] ì—ë””í„°ì—ì„œ ì´ë¯¸ì§€ê°€ ì •ìƒì ìœ¼ë¡œ í‘œì‹œë˜ëŠ”ì§€ í™•ì¸
- [ ] í† ë¡  ìƒì„¸ í˜ì´ì§€ì—ì„œ ì´ë¯¸ì§€ê°€ ì •ìƒì ìœ¼ë¡œ í‘œì‹œë˜ëŠ”ì§€ í™•ì¸
- [ ] ë¸Œë¼ìš°ì € ê°œë°œì ë„êµ¬(F12) â†’ Network íƒ­ì—ì„œ ì´ë¯¸ì§€ ìš”ì²­ì´ 200 OKì¸ì§€ í™•ì¸
- [ ] ë¸Œë¼ìš°ì € ê°œë°œì ë„êµ¬(F12) â†’ Console íƒ­ì—ì„œ Mixed Content ê²½ê³ ê°€ ì—†ëŠ”ì§€ í™•ì¸

## ğŸ”§ ë¬¸ì œ í•´ê²° í›„ í™•ì¸ ë°©ë²•

### 1. ë¸Œë¼ìš°ì € ê°œë°œì ë„êµ¬ í™•ì¸

**Network íƒ­**:

- ì´ë¯¸ì§€ ìš”ì²­ URLì´ `https://debate.me.kr/files/editor/images/...` í˜•ì‹ì¸ì§€ í™•ì¸
- ìƒíƒœ ì½”ë“œê°€ 200 OKì¸ì§€ í™•ì¸

**Console íƒ­**:

- Mixed Content ê´€ë ¨ ê²½ê³ ê°€ ì—†ëŠ”ì§€ í™•ì¸
- ì—ëŸ¬ ë©”ì‹œì§€ê°€ ì—†ëŠ”ì§€ í™•ì¸

### 2. Nginx ë¡œê·¸ í™•ì¸

```bash
# ì ‘ê·¼ ë¡œê·¸ í™•ì¸
sudo tail -f /var/log/nginx/access.log

# ì—ëŸ¬ ë¡œê·¸ í™•ì¸
sudo tail -f /var/log/nginx/error.log
```

### 3. ì´ë¯¸ì§€ íŒŒì¼ í™•ì¸

```bash
# ì´ë¯¸ì§€ íŒŒì¼ì´ ì‹¤ì œë¡œ ì €ì¥ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
ls -la /home/ubuntu/opt/debate/files/editor/images/

# íŒŒì¼ ê¶Œí•œ í™•ì¸ (nginxê°€ ì½ì„ ìˆ˜ ìˆì–´ì•¼ í•¨)
sudo chmod -R 755 /home/ubuntu/opt/debate/files/
```

## ğŸ“ ì°¸ê³  íŒŒì¼

- **Nginx ì„¤ì •**: `debate-https.nginx` (í”„ë¡œì íŠ¸ ë£¨íŠ¸)
- **ìƒì„¸ ê°€ì´ë“œ**: `IMAGE_FIX_GUIDE.md` (í”„ë¡œì íŠ¸ ë£¨íŠ¸)
- **ë°±ì—”ë“œ íŒŒì¼ ì €ì¥ ê²½ë¡œ**: `/home/ubuntu/opt/debate/files/editor/images`
- **ë°±ì—”ë“œ íŒŒì¼ URL prefix**: `/files/editor/images`

## ğŸš¨ ì¶”ê°€ ë¬¸ì œ ë°œìƒ ì‹œ

1. **ì´ë¯¸ì§€ê°€ ì—¬ì „íˆ ë³´ì´ì§€ ì•ŠëŠ” ê²½ìš°**:

   - ë¸Œë¼ìš°ì € ìºì‹œ ì‚­ì œ (Ctrl+Shift+Delete)
   - ì‹œí¬ë¦¿ ëª¨ë“œì—ì„œ í…ŒìŠ¤íŠ¸
   - ë‹¤ë¥¸ ë¸Œë¼ìš°ì €ì—ì„œ í…ŒìŠ¤íŠ¸

2. **403 Forbidden ì—ëŸ¬**:

   - íŒŒì¼ ê¶Œí•œ í™•ì¸: `sudo chmod -R 755 /home/ubuntu/opt/debate/files/`
   - Nginx ì‚¬ìš©ì ê¶Œí•œ í™•ì¸: `sudo chown -R www-data:www-data /home/ubuntu/opt/debate/files/`

3. **404 Not Found ì—ëŸ¬**:

   - Nginx ì„¤ì •ì—ì„œ `/files` ê²½ë¡œê°€ ì˜¬ë°”ë¥´ê²Œ ì„¤ì •ë˜ì—ˆëŠ”ì§€ í™•ì¸
   - ë°±ì—”ë“œì—ì„œ íŒŒì¼ì´ ì‹¤ì œë¡œ ì €ì¥ë˜ì—ˆëŠ”ì§€ í™•ì¸

4. **Mixed Content ê²½ê³ **:
   - í”„ë¡ íŠ¸ì—”ë“œ ì½”ë“œê°€ ìµœì‹  ë²„ì „ìœ¼ë¡œ ë°°í¬ë˜ì—ˆëŠ”ì§€ í™•ì¸
   - ë¸Œë¼ìš°ì € ìºì‹œ ì‚­ì œ

## âœ¨ ì™„ë£Œ í›„ ì˜ˆìƒ ê²°ê³¼

- âœ… ì—ë””í„°ì—ì„œ ì´ë¯¸ì§€ ì—…ë¡œë“œ í›„ ì¦‰ì‹œ í‘œì‹œ
- âœ… í† ë¡  ìƒì„¸ í˜ì´ì§€ì—ì„œ ì´ë¯¸ì§€ ì •ìƒ í‘œì‹œ
- âœ… ë¸Œë¼ìš°ì € ì½˜ì†”ì— ì—ëŸ¬ ì—†ìŒ
- âœ… Network íƒ­ì—ì„œ ì´ë¯¸ì§€ ìš”ì²­ 200 OK
- âœ… Mixed Content ê²½ê³  ì—†ìŒ
